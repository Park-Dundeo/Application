# 카테고리 룰베이스 평가 리포트 (2026-02-13)

## 요약
- **룰 기반 성과: 중간~상**으로 예상됨.
- 반복 상호/키워드가 많은 생활 패턴에서는 **룰만으로도 60~80% 커버** 가능.
- 다만 **문자열 변형/지점명/결제사 prefix** 등으로 인한 미매칭이 잦을 수 있음.

## 잘 되는 이유
- merchant(내용) 기준 exact contains 패턴이 촘촘히 구축되어 있음.
- priority + allowed category 필터로 안정성이 높음.

## 한계/리스크
- 상호 문자열 변형(띄어쓰기/지점명/결제사 prefix)에 취약.
- `네이버파이낸셜`처럼 **중복 규칙** 존재 → 충돌/우선순위 관리 필요.
- 현재는 merchant 위주 → **금액/결제수단/메모/소분류** 등 컨텍스트 활용 부족.
- 룰이 늘수록 유지보수 비용 급격히 증가.

## 개선 우선순위 (효과 큰 순)
1. **상호 정규화 레이어 추가**
   - 예: `GS25분당서현CGV점` → `GS25`, `스타벅스코리아` → `스타벅스`
   - 매칭률 즉시 상승
2. **미분류 리포트 자동화**
   - 룰 미매칭 상위 항목/금액/빈도 리포트 → 룰 추가 우선순위 결정
3. **룰 고도화**
   - contains + regex + amount_range 조합
   - fields 확장: merchant + memo + account + raw_text + sub/main_category
4. **룰 충돌/중복 정리**
   - 동일 패턴 다중 카테고리 탐지 → 룰 관리/버전 규칙 필요
5. **LLM은 미분류만 보조**
   - 룰 실패 건만 보조 → 비용/오류 감소
   - LLM 결과는 후보+confidence로 기록, 확정 시 룰로 환류

## 다음 액션 제안
- **rules.json 중복/충돌 검사 스크립트 추가**
- **merchant 정규화 함수**(전처리) 추가
- **미분류 리포트 스케줄링**(주간/월간)
